
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Opening and managing an SFML window Â· CrSFML Tutorials</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="events.html" />
    
    
    <link rel="prev" href="../system/stream.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://github.com/BlaXpirit/crsfml" target="_blank" class="custom-link">CrSFML</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    CrSFML tutorials
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">System module</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../system/time.html">
            
                <a href="../system/time.html">
            
                    
                    Handling time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../system/thread.html">
            
                <a href="../system/thread.html">
            
                    
                    Threads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../system/stream.html">
            
                <a href="../system/stream.html">
            
                    
                    User data streams
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Window module</li>
        
        
    
        <li class="chapter active" data-level="3.1" data-path="window.html">
            
                <a href="window.html">
            
                    
                    Opening and managing an SFML window
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="events.html">
            
                <a href="events.html">
            
                    
                    Events explained
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="inputs.html">
            
                <a href="inputs.html">
            
                    
                    Keyboard, mouse and joysticks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="opengl.html">
            
                <a href="opengl.html">
            
                    
                    Using OpenGL in an SFML window
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Graphics module</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../graphics/draw.html">
            
                <a href="../graphics/draw.html">
            
                    
                    Drawing 2D stuff
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../graphics/sprite.html">
            
                <a href="../graphics/sprite.html">
            
                    
                    Sprites and textures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../graphics/text.html">
            
                <a href="../graphics/text.html">
            
                    
                    Text and fonts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../graphics/shape.html">
            
                <a href="../graphics/shape.html">
            
                    
                    Shapes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../graphics/vertex-array.html">
            
                <a href="../graphics/vertex-array.html">
            
                    
                    Designing your own entities with vertex arrays
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../graphics/transform.html">
            
                <a href="../graphics/transform.html">
            
                    
                    Position, rotation, scale: transforming entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../graphics/shader.html">
            
                <a href="../graphics/shader.html">
            
                    
                    Adding special effects with shaders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="../graphics/view.html">
            
                <a href="../graphics/view.html">
            
                    
                    Controlling the 2D camera with views
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Audio module</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../audio/sounds.html">
            
                <a href="../audio/sounds.html">
            
                    
                    Playing sounds and music
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../audio/recording.html">
            
                <a href="../audio/recording.html">
            
                    
                    Recording audio
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../audio/streams.html">
            
                <a href="../audio/streams.html">
            
                    
                    Custom audio streams
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../audio/spatialization.html">
            
                <a href="../audio/spatialization.html">
            
                    
                    Spatialization: Sounds in 3D
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Network module</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../network/socket.html">
            
                <a href="../network/socket.html">
            
                    
                    Communication using sockets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../network/packet.html">
            
                <a href="../network/packet.html">
            
                    
                    Using packets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../network/http.html">
            
                <a href="../network/http.html">
            
                    
                    Web requests with HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../network/ftp.html">
            
                <a href="../network/ftp.html">
            
                    
                    File transfers with FTP
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Opening and managing an SFML window</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="opening-and-managing-an-sfml-window">Opening and managing an SFML window</h1>
<p>Relevant example: <strong><a href="https://github.com/BlaXpirit/crsfml/tree/master/examples/simple.cr" target="_blank">simple</a></strong></p>
<h2 id="introduction">Introduction</h2>
<p>This tutorial only explains how to open and manage a window. Drawing stuff is beyond the scope of the sfml-window module: it is handled by the sfml-graphics module. However, the window management remains exactly the same so reading this tutorial is important in any case.</p>
<h2 id="opening-a-window">Opening a window</h2>
<p>Windows in CrSFML are defined by the <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a> class. A window can be created and opened directly upon construction:</p>
<pre><code class="lang-crystal"><span class="hljs-keyword">require</span> <span class="hljs-string">&quot;crsfml&quot;</span>

window = <span class="hljs-symbol">SF:</span>:RenderWindow.new(<span class="hljs-symbol">SF:</span>:VideoMode.new(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>), <span class="hljs-string">&quot;My window&quot;</span>)

...
</code></pre>
<p>The first argument, the <em>video mode</em>, defines the size of the window (the inner size, without the title bar and borders). Here, we create a window with a size of 800x600 pixels.
The <a href="http://blaxpirit.github.io/crsfml/api/SF/VideoMode.html" target="_blank">VideoMode</a> class has some interesting class methods to get the desktop resolution, or the list of valid video modes for fullscreen mode. Don&apos;t hesitate to have a look at its documentation.</p>
<p>The second argument is simply the title of the window.</p>
<p>This constructor accepts a third optional argument: a style, which allows you to choose which decorations and features you want. You can use any combination of the following styles:</p>
<table>
    <tr>
        <td><code>SF::Style::None</code></td>
        <td>No decoration at all (useful for splash screens, for example); this style cannot be combined with others</td>
    </tr>
    <tr>
        <td><code>SF::Style::Titlebar</code></td>
        <td>The window has a titlebar</td>
    </tr>
    <tr>
        <td><code>SF::Style::Resize</code></td>
        <td>The window can be resized and has a maximize button</td>
    </tr>
    <tr>
        <td><code>SF::Style::Close</code></td>
        <td>The window has a close button</td>
    </tr>
    <tr>
        <td><code>SF::Style::Fullscreen</code></td>
        <td>The window is shown in fullscreen mode; this style cannot be combined with others, and requires a valid video mode</td>
    </tr>
    <tr>
        <td><code>SF::Style::Default</code></td>
        <td>The default style, which is a shortcut for <code>Titlebar | Resize | Close</code></td>
    </tr>
</table>

<p>There&apos;s also a fourth optional argument, which defines OpenGL specific options which are explained in the <a href="opengl.html" title="OpenGL tutorial">dedicated OpenGL tutorial</a>.</p>
<h2 id="bringing-the-window-to-life">Bringing the window to life</h2>
<p>If you try to execute the code above with nothing in place of the &quot;...&quot;, you will hardly see anything. First, because the program ends immediately. Second, because there&apos;s no event handling -- so even if you added an endless loop to this code, you would see a dead window, unable to be resized or closed.</p>
<p>Let&apos;s add some code to make this program a bit more interesting:</p>
<pre><code class="lang-crystal"><span class="hljs-keyword">require</span> <span class="hljs-string">&quot;crsfml&quot;</span>

window = <span class="hljs-symbol">SF:</span>:RenderWindow.new(<span class="hljs-symbol">SF:</span>:VideoMode.new(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>), <span class="hljs-string">&quot;My window&quot;</span>)

<span class="hljs-comment"># run the program as long as the window is open</span>
<span class="hljs-keyword">while</span> window.open?
  <span class="hljs-comment"># check all the window&apos;s events that were triggered since the last iteration of the loop</span>
  <span class="hljs-keyword">while</span> event = window.poll_event
    <span class="hljs-comment"># &quot;close requested&quot; event: we close the window</span>
    <span class="hljs-keyword">if</span> event.<span class="hljs-keyword">is_a?</span> <span class="hljs-symbol">SF:</span>:<span class="hljs-symbol">Event:</span>:Closed
      window.close
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>The above code will open a window, and terminate when the user closes it. Let&apos;s see how it works in detail.</p>
<p>First, we added a loop that ensures that the application will be refreshed/updated until the window is closed. Most (if not all) CrSFML programs will have this kind of loop, sometimes called the <em>main loop</em> or <em>game loop</em>.</p>
<p>Then, the first thing that we want to do inside our game loop is check for any events that occurred. Note that we use a <code>while</code> loop so that all pending events are processed in case there were several. The <code>poll_event</code> method returns an event if there was one pending, or <code>nil</code> otherwise.</p>
<p>Whenever we get an event, we must check its type (window closed? key pressed? mouse moved? joystick connected? ...), and react accordingly if we are interested in it. In this case, we only care about the <code>Event::Closed</code> event, which is triggered when the user wants to close the window. At this point, the window is still open and we have to close it explicitly with the <code>close</code> method. This enables you to do something before the window is closed, such as saving the current state of the application, or displaying a message.</p>
<p>A mistake that people often make is to forget the event loop, simply because they don&apos;t yet care about handling events (they use real-time inputs instead). Without an event loop, the window will become unresponsive. It is important to note that the event loop has two roles: in addition to providing events to the user, it gives the window a chance to process its internal events too, which is required so that it can react to move or resize user actions.</p>
<p>After the window has been closed, the main loop exits and the program terminates.</p>
<p>At this point, you probably noticed that we haven&apos;t talked about <em>drawing something</em> to the window yet. As stated in the introduction, this is not the job of the sfml-window module, and you&apos;ll have to jump to the sfml-graphics tutorials if you want to draw things such as sprites, text or shapes.</p>
<p>To draw stuff, you can also use OpenGL directly and totally ignore the sfml-graphics module. <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a> internally creates an OpenGL context and is ready to accept your OpenGL calls. You can learn more about that in the <a href="opengl.html" title="OpenGL tutorial">corresponding tutorial</a>.</p>
<p>Don&apos;t expect to see anything interesting in this window: you may see a uniform color (black or white), or the last contents of the previous application that used OpenGL, or... something else.</p>
<h2 id="playing-with-the-window">Playing with the window</h2>
<p>Of course, CrSFML allows you to play with your windows a bit. Basic window operations such as changing the size, position, title or icon are supported, but unlike dedicated GUI libraries, SFML doesn&apos;t provide advanced features. SFML windows are only meant to provide an environment for OpenGL or SFML drawing.</p>
<pre><code class="lang-crystal"><span class="hljs-comment"># change the position of the window (relatively to the desktop)</span>
window.position = SF.vector2(<span class="hljs-number">10</span>, <span class="hljs-number">50</span>)

<span class="hljs-comment"># change the size of the window</span>
window.size = SF.vector2(<span class="hljs-number">640</span>, <span class="hljs-number">480</span>)

<span class="hljs-comment"># change the title of the window</span>
window.title = <span class="hljs-string">&quot;SFML window&quot;</span>

<span class="hljs-comment"># get the size of the window</span>
size = window.size
width = size.x
height = size.y

...
</code></pre>
<p>You can refer to the API documentation for a complete list of <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a>&apos;s methods.</p>
<p>In case you really need advanced features for your window, you can create one (or even a full GUI) with another library, and embed SFML into it. To do so, you can use the other constructor of <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a> which takes the OS-specific handle of an existing window. In this case, SFML will create a drawing context inside the given window and catch all its events without interfering with the parent window management.</p>
<pre><code class="lang-crystal">handle = ... <span class="hljs-comment"># specific to what you&apos;re doing and the library you&apos;re using</span>
<span class="hljs-symbol">SF:</span>:Window.from_handle(handle)
</code></pre>
<p>If you just want an additional, very specific feature, you can also do it the other way round: create an SFML window and get its OS-specific handle to implement things that SFML itself doesn&apos;t support.</p>
<pre><code class="lang-crystal">window = <span class="hljs-symbol">SF:</span>:RenderWindow.new(<span class="hljs-symbol">SF:</span>:VideoMode.new(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>), <span class="hljs-string">&quot;SFML window&quot;</span>)
handle = window.system_handle

<span class="hljs-comment"># you can now use the handle with OS specific functions</span>
</code></pre>
<p>Integrating SFML with other libraries requires some work and won&apos;t be described here, but you can refer to the dedicated tutorials, examples or forum posts.</p>
<h2 id="controlling-the-framerate">Controlling the framerate</h2>
<p>Sometimes, when your application runs fast, you may notice visual artifacts such as tearing. The reason is that your application&apos;s refresh rate is not synchronized with the vertical frequency of the monitor, and as a result, the bottom of the previous frame is mixed with the top of the next one.<br>The solution to this problem is to activate <em>vertical synchronization</em>. It is automatically handled by the graphics card, and can easily be switched on and off with the <code>vertical_sync_enabled=</code> method:</p>
<pre><code class="lang-crystal">window.vertical_sync_enabled = <span class="hljs-literal">true</span> <span class="hljs-comment"># call it once, after creating the window</span>
</code></pre>
<p>After this call, your application will run at the same frequency as the monitor&apos;s refresh rate.</p>
<p>Sometimes <code>vertical_sync_enabled=</code> will have no effect: this is most likely because vertical synchronization is forced to &quot;off&quot; in your graphics driver&apos;s settings. It should be set to &quot;controlled by application&quot; instead.</p>
<p>In other situations, you may also want your application to run at a given framerate, instead of the monitor&apos;s frequency. This can be done by calling <code>framerate_limit=</code>:</p>
<pre><code class="lang-crystal">window.framerate_limit = <span class="hljs-number">60</span> <span class="hljs-comment"># call it once, after creating the window</span>
</code></pre>
<p>Unlike <code>vertical_sync_enabled=</code>, this feature is implemented by SFML itself, using a combination of <a href="http://blaxpirit.github.io/crsfml/api/SF/Clock.html" target="_blank">Clock</a> and <code>SF.sleep</code>. An important consequence is that it is not 100% reliable, especially for high framerates: <code>SF.sleep</code>&apos;s resolution depends on the underlying operating system and hardware, and can be as high as 10 or 15 milliseconds. Don&apos;t rely on this feature to implement precise timing.</p>
<p>Never use both <code>vertical_sync_enabled</code> and <code>framerate_limit</code> at the same time! They would badly mix and make things worse.</p>
<h2 id="things-to-know-about-windows">Things to know about windows</h2>
<p>Here is a brief list of what you can and cannot do with SFML windows.</p>
<h3 id="you-can-create-multiple-windows">You can create multiple windows</h3>
<p>SFML allows you to create multiple windows, and to handle them either all in the main thread, or each one in its own thread (but... see below). In this case, don&apos;t forget to have an event loop for each window.</p>
<h3 id="multiple-monitors-are-not-correctly-supported-yet">Multiple monitors are not correctly supported yet</h3>
<p>SFML doesn&apos;t explicitly manage multiple monitors. As a consequence, you won&apos;t be able to choose which monitor a window appears on, and you won&apos;t be able to create more than one fullscreen window. This should be improved in a future version.</p>
<h3 id="events-must-be-polled-in-the-windows-thread">Events must be polled in the window&apos;s thread</h3>
<p>This is an important limitation of most operating systems: the event loop (more precisely, the <code>poll_event</code> or <code>wait_event</code> method) must be called in the same thread that created the window. This means that if you want to create a dedicated thread for event handling, you&apos;ll have to make sure that the window is created in this thread too. If you really want to split things between threads, it is more convenient to keep event handling in the main thread and move the rest (rendering, physics, logic, ...) to a separate thread instead. This configuration will also be compatible with the other limitation described below.</p>
<h3 id="on-os-x-windows-and-events-must-be-managed-in-the-main-thread">On OS X, windows and events must be managed in the main thread</h3>
<p>Yep, that&apos;s true. Mac OS X just won&apos;t agree if you try to create a window or handle events in a thread other than the main one.</p>
<h3 id="on-windows-a-window-which-is-bigger-than-the-desktop-will-not-behave-correctly">On Windows, a window which is bigger than the desktop will not behave correctly</h3>
<p>For some reason, Windows doesn&apos;t like windows that are bigger than the desktop. This includes windows created with <code>VideoMode.get_desktop_mode</code>: with the window decorations (borders and titlebar) added, you end up with a window which is slightly bigger than the desktop.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../system/stream.html" class="navigation navigation-prev " aria-label="Previous page: User data streams">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="events.html" class="navigation navigation-next " aria-label="Next page: Events explained">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Opening and managing an SFML window","level":"3.1","depth":1,"next":{"title":"Events explained","level":"3.2","depth":1,"path":"window/events.md","ref":"window/events.md","articles":[]},"previous":{"title":"User data streams","level":"2.3","depth":1,"path":"system/stream.md","ref":"system/stream.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"api":"http://blaxpirit.github.io/crsfml/api/SF","examples":"https://github.com/BlaXpirit/crsfml/tree/master/examples","examples2":"https://github.com/BlaXpirit/crsfml-examples/tree/master"},"title":"CrSFML Tutorials","links":{"sidebar":{"CrSFML":"http://github.com/BlaXpirit/crsfml"}},"gitbook":">= 3.0.0"},"file":{"path":"window/window.md","mtime":"2018-03-07T21:44:51.463Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-07T21:45:56.311Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>



<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Drawing 2D stuff Â· CrSFML Tutorials</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="sprite.html" />
    
    
    <link rel="prev" href="../window/opengl.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://github.com/BlaXpirit/crsfml" target="_blank" class="custom-link">CrSFML</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    CrSFML tutorials
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">System module</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../system/time.html">
            
                <a href="../system/time.html">
            
                    
                    Handling time
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../system/thread.html">
            
                <a href="../system/thread.html">
            
                    
                    Threads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../system/stream.html">
            
                <a href="../system/stream.html">
            
                    
                    User data streams
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Window module</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../window/window.html">
            
                <a href="../window/window.html">
            
                    
                    Opening and managing an SFML window
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../window/events.html">
            
                <a href="../window/events.html">
            
                    
                    Events explained
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../window/inputs.html">
            
                <a href="../window/inputs.html">
            
                    
                    Keyboard, mouse and joysticks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../window/opengl.html">
            
                <a href="../window/opengl.html">
            
                    
                    Using OpenGL in an SFML window
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Graphics module</li>
        
        
    
        <li class="chapter active" data-level="4.1" data-path="draw.html">
            
                <a href="draw.html">
            
                    
                    Drawing 2D stuff
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="sprite.html">
            
                <a href="sprite.html">
            
                    
                    Sprites and textures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="text.html">
            
                <a href="text.html">
            
                    
                    Text and fonts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="shape.html">
            
                <a href="shape.html">
            
                    
                    Shapes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="vertex-array.html">
            
                <a href="vertex-array.html">
            
                    
                    Designing your own entities with vertex arrays
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="transform.html">
            
                <a href="transform.html">
            
                    
                    Position, rotation, scale: transforming entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="shader.html">
            
                <a href="shader.html">
            
                    
                    Adding special effects with shaders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="view.html">
            
                <a href="view.html">
            
                    
                    Controlling the 2D camera with views
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Audio module</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../audio/sounds.html">
            
                <a href="../audio/sounds.html">
            
                    
                    Playing sounds and music
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../audio/recording.html">
            
                <a href="../audio/recording.html">
            
                    
                    Recording audio
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../audio/streams.html">
            
                <a href="../audio/streams.html">
            
                    
                    Custom audio streams
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../audio/spatialization.html">
            
                <a href="../audio/spatialization.html">
            
                    
                    Spatialization: Sounds in 3D
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Network module</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../network/socket.html">
            
                <a href="../network/socket.html">
            
                    
                    Communication using sockets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../network/packet.html">
            
                <a href="../network/packet.html">
            
                    
                    Using packets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../network/http.html">
            
                <a href="../network/http.html">
            
                    
                    Web requests with HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../network/ftp.html">
            
                <a href="../network/ftp.html">
            
                    
                    File transfers with FTP
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Drawing 2D stuff</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="drawing-2d-stuff">Drawing 2D stuff</h1>
<h2 id="introduction">Introduction</h2>
<p>As you learnt in the previous tutorials, CrSFML&apos;s window module provides an easy way to open an OpenGL window and handle its events, but it doesn&apos;t help when it comes to drawing something. The only option which is left to you is to use the powerful, yet complex and low level OpenGL API.</p>
<p>Fortunately, CrSFML provides a graphics module which will help you draw 2D entities in a much simpler way than with OpenGL.</p>
<h2 id="the-drawing-window">The drawing window</h2>
<p>To draw the entities provided by the graphics module, you must use a specialized window class: <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderWindow.html" target="_blank">RenderWindow</a>. This class is derived from <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a>, and inherits all its methods. Everything that you&apos;ve learnt about <a href="http://blaxpirit.github.io/crsfml/api/SF/Window.html" target="_blank">Window</a> (creation, event handling, controlling the framerate, mixing with OpenGL, etc.) is applicable to <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderWindow.html" target="_blank">RenderWindow</a> as well.</p>
<p>On top of that, <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderWindow.html" target="_blank">RenderWindow</a> adds high-level methods to help you draw things easily. In this tutorial we&apos;ll focus on two of these methods: <code>clear</code> and <code>draw</code>. They are as simple as their name implies: <code>clear</code> clears the whole window with the chosen color, and <code>draw</code> draws whatever object you pass to it.</p>
<p>Here is what a typical main loop looks like with a render window:</p>
<pre><code class="lang-crystal"><span class="hljs-keyword">require</span> <span class="hljs-string">&quot;crsfml&quot;</span>

<span class="hljs-comment"># create the window</span>
window = <span class="hljs-symbol">SF:</span>:RenderWindow.new(<span class="hljs-symbol">SF:</span>:VideoMode.new(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>), <span class="hljs-string">&quot;My window&quot;</span>)

<span class="hljs-comment"># run the program as long as the window is open</span>
<span class="hljs-keyword">while</span> window.open?
  <span class="hljs-comment"># check all the window&apos;s events that were triggered since the last iteration of the loop</span>
  <span class="hljs-keyword">while</span> event = window.poll_event
    <span class="hljs-comment"># &quot;close requested&quot; event: we close the window</span>
    <span class="hljs-keyword">if</span> event.<span class="hljs-keyword">is_a?</span> <span class="hljs-symbol">SF:</span>:<span class="hljs-symbol">Event:</span>:Closed
      window.close
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment"># clear the window with black color</span>
  window.clear(<span class="hljs-symbol">SF:</span>:<span class="hljs-symbol">Color:</span>:Black)

  <span class="hljs-comment"># draw everything here...</span>
  window.draw(...)

  <span class="hljs-comment"># end the current frame</span>
  window.display
<span class="hljs-keyword">end</span>
</code></pre>
<p>Calling <code>clear</code> before drawing anything is mandatory, otherwise the contents from previous frames will be present behind anything you draw. The only exception is when you cover the entire window with what you draw, so that no pixel is not drawn to. In this case you can avoid calling <code>clear</code> (although it won&apos;t have a noticeable impact on performance).</p>
<p>Calling <code>display</code> is also mandatory, it takes what was drawn since the last call to <code>display</code> and displays it on the window. Indeed, things are not drawn directly to the window, but to a hidden buffer. This buffer is then copied to the window when you call <code>display</code> &#x2013; this is called <em>double-buffering</em>.</p>
<p>This clear/draw/display cycle is the only good way to draw things. Don&apos;t try other strategies, such as keeping pixels from the previous frame, &quot;erasing&quot; pixels, or drawing once and calling display multiple times. You&apos;ll get strange results due to double-buffering.<br>Modern graphics hardware and APIs are <em>really</em> made for repeated clear/draw/display cycles where everything is completely refreshed at each iteration of the main loop. Don&apos;t be scared to draw 1000 sprites 60 times per second, you&apos;re far below the millions of triangles that your computer can handle.</p>
<h2 id="what-can-i-draw-now">What can I draw now?</h2>
<p>Now that you have a main loop which is ready to draw, let&apos;s see what, and how, you can actually draw there.</p>
<p>SFML provides four kinds of drawable entities: three of them are ready to be used (<em>sprites</em>, <em>text</em> and <em>shapes</em>), the last one is the building block that will help you create your own drawable entities (<em>vertex arrays</em>).</p>
<p>Although they share some common properties, each of these entities come with their own nuances and are therefore explained in dedicated tutorials:</p>
<ul>
<li><a href="sprite.html" title="Learn how to create and draw sprites">Sprite tutorial</a></li>
<li><a href="text.html" title="Learn how to create and draw text">Text tutorial</a></li>
<li><a href="shape.html" title="Learn how to create and draw shapes">Shape tutorial</a></li>
<li><a href="vertex-array.html" title="Learn how to create and draw vertex arrays">Vertex array tutorial</a></li>
</ul>
<h2 id="off-screen-drawing">Off-screen drawing</h2>
<p>SFML also provides a way to draw to a texture instead of directly to a window. To do so, use a <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderTexture.html" target="_blank">RenderTexture</a> instead of a <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderWindow.html" target="_blank">RenderWindow</a>. It has the same methods for drawing, inherited from their common base: <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderTarget.html" target="_blank">RenderTarget</a>.</p>
<pre><code class="lang-crystal"><span class="hljs-comment"># create a 500x500 render-texture</span>
render_texture = <span class="hljs-symbol">SF:</span>:RenderTexture.new(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>)

<span class="hljs-comment"># drawing uses the same methods</span>
render_texture.clear(<span class="hljs-symbol">SF:</span>:<span class="hljs-symbol">Color:</span>:Blue)
render_texture.draw(sprite) <span class="hljs-comment"># or any other drawable</span>
render_texture.display

<span class="hljs-comment"># get the target texture (where the stuff has been drawn)</span>
texture = render_texture.texture

<span class="hljs-comment"># draw it to the window</span>
sprite = <span class="hljs-symbol">SF:</span>:Sprite.new(texture)
window.draw(sprite)
</code></pre>
<p>The <code>texture</code> method returns a read-only texture, which means that you can only use it, not modify it. If you need to modify it before using it, you can copy it to your own <a href="http://blaxpirit.github.io/crsfml/api/SF/Texture.html" target="_blank">Texture</a> instance and modify that instead.</p>
<p><a href="http://blaxpirit.github.io/crsfml/api/SF/RenderTexture.html" target="_blank">RenderTexture</a> also has the same methods as <a href="http://blaxpirit.github.io/crsfml/api/SF/RenderWindow.html" target="_blank">RenderWindow</a> for handling views and OpenGL (see the corresponding tutorials for more details). If you use OpenGL to draw to the render-texture, you can request creation of a depth buffer by using the third optional argument of the constructor.</p>
<pre><code class="lang-crystal"><span class="hljs-symbol">SF:</span>:RenderTexture.new(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>, <span class="hljs-literal">true</span>) <span class="hljs-comment"># enable depth buffer</span>
</code></pre>
<h2 id="drawing-from-threads">Drawing from threads</h2>
<p>CrSFML supports multi-threaded drawing, and you don&apos;t even have to do anything to make it work. The only thing to remember is to deactivate a window before using it in another thread. That&apos;s because a window (more precisely its OpenGL context) cannot be active in more than one thread at the same time.</p>
<pre><code class="lang-crystal"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">render_thread</span></span>(window)
  <span class="hljs-comment"># the rendering loop</span>
  <span class="hljs-keyword">while</span> window.open?
    <span class="hljs-comment"># draw...</span>

    <span class="hljs-comment"># end the current frame</span>
    window.display
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># create the window (remember: it&apos;s safer to create it in the main thread due to OS limitations)</span>
window = <span class="hljs-symbol">SF:</span>:RenderWindow.new(<span class="hljs-symbol">SF:</span>:VideoMode.new(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>), <span class="hljs-string">&quot;OpenGL&quot;</span>)

<span class="hljs-comment"># deactivate its OpenGL context</span>
window.active = <span class="hljs-literal">false</span>

<span class="hljs-comment"># launch the rendering thread</span>
thread = <span class="hljs-symbol">SF:</span>:Thread.new(-&gt;{ render_thread(window) })
thread.launch

<span class="hljs-comment"># the event/logic/whatever loop</span>
<span class="hljs-keyword">while</span> window.open?
  ...
<span class="hljs-keyword">end</span>
</code></pre>
<p>As you can see, you don&apos;t even need to bother with the activation of the window in the rendering thread, CrSFML does it automatically for you whenever it needs to be done.</p>
<p>Remember to always create the window and handle its events in the main thread for maximum portability. This is explained in the <a href="../window/window.html" title="Window tutorial">window tutorial</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../window/opengl.html" class="navigation navigation-prev " aria-label="Previous page: Using OpenGL in an SFML window">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="sprite.html" class="navigation navigation-next " aria-label="Next page: Sprites and textures">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Drawing 2D stuff","level":"4.1","depth":1,"next":{"title":"Sprites and textures","level":"4.2","depth":1,"path":"graphics/sprite.md","ref":"graphics/sprite.md","articles":[]},"previous":{"title":"Using OpenGL in an SFML window","level":"3.4","depth":1,"path":"window/opengl.md","ref":"window/opengl.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"api":"http://blaxpirit.github.io/crsfml/api/SF","examples":"https://github.com/BlaXpirit/crsfml/tree/master/examples","examples2":"https://github.com/BlaXpirit/crsfml-examples/tree/master"},"title":"CrSFML Tutorials","links":{"sidebar":{"CrSFML":"http://github.com/BlaXpirit/crsfml"}},"gitbook":">= 3.0.0"},"file":{"path":"graphics/draw.md","mtime":"2018-03-07T21:44:51.452Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-07T21:45:56.311Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

